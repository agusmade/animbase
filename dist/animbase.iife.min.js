var AnimBase=function(e){"use strict";const t=e=>e.match(/^([\w]{2})([\w]{2})([\w]{2})([\w]{2})$/).slice(1).map((e=>parseInt(e,16))),n=e=>{const t=e.match(/^#(?:([0-f]{3})|([0-f]{4})|([0-f]{6})|([0-f]{8}))$/);if(!t)throw Error("Unsupported color format");const[,n,a,i,r]=t;return n?n.split("").map((e=>e+e)).join("")+"ff":a?a.split("").map((e=>e+e)).join(""):i?i+"ff":r},a={linear:e=>e,ease:e=>e*e*(3-2*e),in:e=>e*e*e,out:e=>1-Math.pow(1-e,3),inOut:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,inQuad:e=>e*e,outQuad:e=>e*(2-e),inOutQuad:e=>e<.5?2*e*e:(4-2*e)*e-1,inCubic:e=>e*e*e,outCubic:e=>--e*e*e+1,inOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,inQuart:e=>e*e*e*e,outQuart:e=>1- --e*e*e*e,inOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,inQuint:e=>e*e*e*e*e,outQuint:e=>1+--e*e*e*e*e,inOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,inSine:e=>1-Math.cos(e*Math.PI/2),outSine:e=>Math.sin(e*Math.PI/2),inOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,inExpo:e=>0===e?0:Math.pow(2,10*(e-1)),outExpo:e=>1===e?1:1-Math.pow(2,-10*e),inOutExpo:e=>0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,10-20*e))/2,inCirc:e=>1-Math.sqrt(1-Math.pow(e,2)),outCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),inOutCirc:e=>e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2,inBack:e=>2.70158*e*e*e-1.70158*e*e,outBack:e=>1+2.70158*--e*e*e+1.70158*e*e,inOutBack:e=>e<.5?Math.pow(2*e,2)*(7.189819*e-2.5949095)/2:(Math.pow(2*e-2,2)*(3.5949095*(2*e-2)+2.5949095)+2)/2,inElastic:e=>0===e?0:1===e?1:-Math.pow(2,10*e-10)*Math.sin(2*(10*e-10.75)*Math.PI/3),outElastic:e=>0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(2*(10*e-.75)*Math.PI/3)+1,inOutElastic:e=>0===e?0:1===e?1:e<.5?-Math.pow(2,20*e-10)*Math.sin(2*(20*e-11.125)*Math.PI/4.5)/2:Math.pow(2,-20*e+10)*Math.sin(2*(20*e-11.125)*Math.PI/4.5)/2+1,inBounce:e=>1-a.outBounce(1-e),outBounce:e=>e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,inOutBounce:e=>e<.5?(1-a.outBounce(1-2*e))/2:(1+a.outBounce(2*e-1))/2,spring:(e,t=4.5,n=6)=>1-Math.cos(e*t*Math.PI)*Math.exp(-e*n)},i=(e,t,n,a,i)=>a+(e-t)*(i-a)/(n-t);let r={color:/#[0-f]{3,}/,number:/-?\d+(?:\.\d+)?/,unit:/[%a-zA-Z]*/,func:/[a-zA-Z]+/};r={...r,numberWithOptionalUnit:new RegExp(`(?:(${r.color.source})|(?:(${r.number.source})(${r.unit.source})?))`)},r={...r,numberWithOptionalUnitAndFunc:new RegExp(`${r.numberWithOptionalUnit.source}(?:\\.(${r.func.source}))?`)};const o=e=>{const t=RegExp(r.numberWithOptionalUnitAndFunc.source,"g");let n,i=[];for(;null!==(n=t.exec(e));){let[e,r,o,s,u]=n;if(u&&!a[u])throw Error(`Invalid easing function: ${u}`);i.push({type:r?"color":"number",text:e,value:r||parseFloat(o),unit:s,func:u,lastIndex:t.lastIndex})}return i};function s(e,t,n){let a=[...t].reverse(),i=[...n].reverse();for(let t=0;t<a.length;t++){const n=a[t].lastIndex-a[t].text.length,r=a[t].lastIndex;e=e.substring(0,n)+i[t]+e.substring(r)}return e}const u=({startValue:e,endValue:r,startFrame:o=0,endFrame:s,currentFrame:u,func:l="linear",type:c}={})=>{if(e===r)return e;let m=i(u,o,s,0,1);const p=a[l](m);return"color"===c?((e,a,i)=>{const r=t(n(a)),o=t(n(i));return"#"+r.map(((t,n)=>Math.round(Math.max(0,Math.min(255,t+(o[n]-t)*e))).toString(16).padStart(2,"0"))).join("")})(p,e,r):i(p,0,1,e,r)};class l{constructor(e,t={}){this.element=e;const n=e.dataset.animConfig?JSON.parse(e.dataset.animConfig):{},a=e.dataset.animInit?JSON.parse(e.dataset.animInit):{},i={};let r=0,l={},c={};for(let[e,t]of Object.entries(a))l[e]=o(t),c[e]=[...l[e]];for(let[e,t]of Object.entries(n)){const n=parseInt(e,10);i[e]={startFrame:r,endFrame:n,ref:c,props:{}};for(let[n,a]of Object.entries(t)){const t=o(a);c={...c,[n]:t},i[e].props[n]=t}r=n+1}this.styleConfig=i,this.update=(e,t=!1)=>{let n={};const r=Object.entries(i),o=r.find((([,t])=>t.startFrame<=e&&t.endFrame>=e));if(o){const i=o[1];for(let[r,o]of Object.entries(i.ref)){const c=i.props[r]?i.props[r].map(((t,n)=>`${u({startValue:o[n].value,endValue:t.value,startFrame:i.startFrame,endFrame:i.endFrame,currentFrame:e,func:t.func,type:t.type})}${t.unit||""}`)):o.map((e=>`${e.value}${e.unit||""}`));t?n[r]=s(a[r],l[r],c):this.element.style[r]=s(a[r],l[r],c)}}else{const e=r[r.length-1][1];for(let[i,r]of Object.entries(e.ref)){const o=e.props[i]?e.props[i].map((e=>`${e.value}${e.unit||""}`)):r.map((e=>`${e.value}${e.unit||""}`));t?n[i]=s(a[i],l[i],o):this.element.style[i]=s(a[i],l[i],o)}}if(t)return n}}}class c{constructor(e,t={}){this.getTimelineValue=e,this.animatedElements=new Map,this.timelineValue=0,this.elementSelector=t.elementSelector||"[data-anim-config]",this.collectAnimatedElements(),this.updateTimeline()}collectAnimatedElements(){document.querySelectorAll(this.elementSelector).forEach((e=>{if(!e.dataset.animConfig)return;const t=new l(e);this.animatedElements.set(e,t)}))}updateTimeline(){this.timelineValue=this.getTimelineValue(),this.updateAllAnimatedElements()}updateAllAnimatedElements(){this.animatedElements.forEach((e=>{e.update(this.timelineValue)}))}}var m=Object.freeze({__proto__:null,AnimatedElement:l,TimelineAnimator:c,easingFunctions:a,linearInterpolation:i,parseExpression:o});const p=new Map,d=new Map;function h(e,t=""){return`timed::${t}`}function f(e){const t=()=>{let n=(performance.now()-e.startTime)/e.duration;n=Math.max(0,Math.min(1,n));const a=e.reverse?1-n:n;if(e.frame=Math.floor(a*e.max),e.animator.updateTimeline(),n>=1){if(e.once)return e.running=!1,void(e.onFinish&&e.onFinish());e.startTime=performance.now(),e.onFinish&&e.onFinish()}e.running&&requestAnimationFrame(t)};t()}function g(){document.querySelectorAll("[data-anim-controller-ref], [data-anim-controlled-by], [data-anim-trigger-group]").forEach((e=>{if(e.dataset.animControllerRef){const t=e.dataset.animControllerRef,n=document.querySelector(t);if(!n)return console.warn("Missing controller:",t);if(!d.has(t)){const e=()=>parseFloat(n.value||0);d.set(t,new c(e,{elementSelector:`[data-anim-controller-ref="${t}"]`})),n.addEventListener("input",(()=>d.get(t).updateTimeline()))}}else if(e.dataset.animControlledBy){const t=e.dataset.animControlledBy,n=`scroll-${t}`;if(!d.has(n)){const e=()=>"scrollLeft"===t?window.scrollX:window.scrollY;d.set(n,new c(e,{elementSelector:`[data-anim-controlled-by="${t}"]`})),window.addEventListener("scroll",(()=>d.get(n).updateTimeline()))}}else if(e.dataset.animTriggerGroup){const t=e.dataset.animTriggerGroup,n=h(0,t),a=document.querySelector(`[data-anim-trigger-group="${t}"][data-anim-trigger-config]`);if(!p.has(n)){let e=a?.dataset.animTriggerConfig;e=e?JSON.parse(e):{};const i=e.max||100,r=1e3/(e.speed||60)*i,o=e.autostart||!1,s={frame:0,max:i,duration:r,animator:null,running:!1,startTime:0,pauseTime:0,once:e.once||!1,reverse:e.reverse||!1,onStart:null,onFinish:null},u=()=>s.frame;s.animator=new c(u,{elementSelector:`[data-anim-trigger-group="${t}"]:not([data-anim-trigger-config])`}),d.set(t,s.animator),p.set(n,s),o&&window.AnimBase.trigger(t)}}else;}))}return window.AnimBase=window.AnimBase||{},["trigger","pause","resume","stop","seek","setOnce","setReverse","setHooks"].forEach((e=>{window.AnimBase[e]=function(t){const n=h(0,t),a=p.get(n);if(a)switch(e){case"trigger":a.running||(a.running=!0,a.onStart&&a.onStart(),a.startTime=performance.now(),f(a));break;case"pause":a.running=!1,a.pauseTime=performance.now();break;case"resume":const e=performance.now()-a.pauseTime;a.startTime+=e,a.running=!0,f(a);break;case"stop":a.running=!1,a.frame=a.reverse?a.max:0,a.animator.updateTimeline();break;case"seek":a.frame=Math.max(0,Math.min(a.max,arguments[1]||0)),a.animator.updateTimeline();break;case"setOnce":a.once=!!arguments[1];break;case"setReverse":a.reverse=!!arguments[1];break;case"setHooks":const{onStart:t,onFinish:n}=arguments[1]||{};t&&(a.onStart=t),n&&(a.onFinish=n)}}})),window.AnimBase.refresh=g,document.addEventListener("DOMContentLoaded",g),"undefined"!=typeof window&&(window.AnimBase=window.AnimBase||{},Object.assign(window.AnimBase,m)),e.AnimatedElement=l,e.TimelineAnimator=c,e.easingFunctions=a,e.linearInterpolation=i,e.parseExpression=o,e}({});
//# sourceMappingURL=animbase.iife.min.js.map
